<!DOCTYPE html>
<html>

<head>

    <meta charset="UTF-8">
    <title>Portal loading...</title>
    <script src="./js/data-dog.js"></script>
    <script type="module" src="./js/portal.js"></script>
    <script type="module">
        import { render } from "./js/render.js";
        import { signOut } from "./js/auth.js";
        const main = document.querySelector("main");
        document.addEventListener("DOMContentLoaded", async () => {

            await render(main);

            let homeUrl = new URL(location.href);
            homeUrl.searchParams.delete("_");
            homeUrl = homeUrl.toString();

            for (let signOutButton of main.querySelectorAll("button.sign-out")) {

                signOutButton.addEventListener("click", () => signOut(homeUrl));

            }
            for (let homeLink of main.querySelectorAll("a.home-link")) {

                homeLink.href = homeUrl;

            }

        });
    </script>

</head>

<body>

    <header>

        <h1 data-text-content="displayName"></h1>

    </header>
    <template id="home">

        <section class="data-list" data-query="public/documents/{ptid}?disposition=grant">

            <div class="output"></div>
            <div class="error" data-error-text-content="true">

            </div>
            <template>

                <section data-add-class="id,tenant">

                    <h2 data-text-content="name"></h2>
                    <a data-href="?_=/create-application/{tenant}/{id}&ptid={ptid}">Apply here</a>

                </section>

            </template>

        </section>

    </template>

    <template id="create-application" class="secured">

        <nav></nav>

    </template>

    <template id="default_nav">

        <nav>

            <a class="home-link">Home</a>
            <button class="sign-out">Sign out</button>

        </nav>

    </template>

    <main>

    </main>

</body>